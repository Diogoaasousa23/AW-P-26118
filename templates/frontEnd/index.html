<!DOCTYPE html>
<html lang="pt">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Carros</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />
  </head>
  <body>
    <h1>Carros</h1>
    <div class="container">
      <div class="row" id="cardCarros">
        <div class="col-md-6">
          carro1
          <div class="card">
            <img
              class="card-img-top"
              src="https://www.motor24.pt/files/2019/03/1681733_Ferrari_F8_Tributo_4-800x533_c.jpg"
              alt="Card image"
            />
            <div class="card-img-overlay">
              <h4 class="card-title">Ferrari</h4>
              <a
                href="#"
                class="btn btn-primary"
                data-bs-toggle="modal"
                data-bs-target="#myModal"
                onclick="carregaModal('Porsche', 'Boxster 987', this)"
                >Ver detalhes</a
              >
            </div>
          </div>
        </div>
        <div class="col-md-6">
          carro2
          <div class="card">
            <img
              class="card-img-top"
              src="https://www.motor24.pt/files/2019/03/1681733_Ferrari_F8_Tributo_4-800x533_c.jpg"
              alt="Card image"
            />
            <div class="card-img-overlay">
              <h4 class="card-title">Ferrari</h4>
              <a
                href="#"
                class="btn btn-primary"
                data-bs-toggle="modal"
                data-bs-target="#myModal"
                onclick="carregaModal('Porsche', 'Boxster 987', this)"
                >Ver detalhes</a
              >
            </div>
          </div>
        </div>
        <div class="col-md-6">
          carro3
          <div class="card">
            <img
              class="card-img-top"
              src="https://www.motor24.pt/files/2019/03/1681733_Ferrari_F8_Tributo_4-800x533_c.jpg"
              alt="Card image"
            />
            <div class="card-img-overlay">
              <h4 class="card-title">Ferrari</h4>
              <a
                href="#"
                class="btn btn-primary"
                data-bs-toggle="modal"
                data-bs-target="#myModal"
                onclick="carregaModal('Porsche', 'Boxster 987', this)"
                >Ver detalhes</a
              >
            </div>
          </div>
        </div>
        <div class="col-md-6">
          carro4
          <div class="card">
            <img
              class="card-img-top"
              src="https://www.motor24.pt/files/2019/03/1681733_Ferrari_F8_Tributo_4-800x533_c.jpg"
              alt="Card image"
            />
            <div class="card-img-overlay">
              <h4 class="card-title">Ferrari</h4>
              <a
                href="#"
                class="btn btn-primary"
                data-bs-toggle="modal"
                data-bs-target="#myModal"
                onclick="carregaModal('Porsche', 'Boxster 987', this)"
                >Ver detalhes</a
              >
            </div>
          </div>
        </div>
        <div class="col-md-6">
          carro5
          <div class="card">
            <img
              class="card-img-top"
              src="https://www.motor24.pt/files/2019/03/1681733_Ferrari_F8_Tributo_4-800x533_c.jpg"
              alt="Card image"
            />
            <div class="card-img-overlay">
              <h4 class="card-title">Ferrari</h4>
              <a
                href="#"
                class="btn btn-primary"
                data-bs-toggle="modal"
                data-bs-target="#myModal"
                onclick="carregaModal('Porsche', 'Boxster 987', this)"
                >Ver detalhes</a
              >
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- The Modal -->
    <div class="modal" id="myModal">
      <div class="modal-dialog">
        <div class="modal-content">
          <!-- Modal Header -->
          <div class="modal-header">
            <h4 class="modal-title" id="mtitulo">Carro</h4>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
            ></button>
          </div>
          <!-- Modal body -->
          <div class="modal-body" id="mdetalhe">Informação do Carro</div>
          <img
            class="img-fluid"
            id="mImagem"
            src="https://www.motor24.pt/files/2019/03/1681733_Ferrari_F8_Tributo_4-800x533_c.jpg"
            alt="Card image"
          />
          <!-- Modal footer -->
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-danger"
              data-bs-dismiss="modal"
            >
              Fechar
            </button>
          </div>
        </div>
      </div>
    </div>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
      crossorigin="anonymous"
    ></script>
    <script>
      function carregaModal(titulo, detalhe, elemento) {
        document.getElementById("mtitulo").innerHTML = titulo;
        document.getElementById("mdetalhe").innerHTML = detalhe;
        document.getElementById("mImagem").src =
          elemento.parentNode.parentNode.firstElementChild.getAttribute("src");
        console.log(
          elemento.parentNode.parentNode.firstElementChild.getAttribute("src")
        );
      }
    </script>
    <script>
      const atualizarCarros = async () => {
        let strHtml = ``;
        //alert("aaaa")
        const response = await fetch("http://localhost:4242/api/pgs/carros/");
        const lv = await response.json();
        for (const artigo of lv) {
          strHtml += `
              <div class="col-md-6">
                <div class="card" >
                  <img class="card-img-top" src="${artigo.Foto}" alt="${artigo.Marca}">
                  <div class="card-img-overlay">
                    <h4 class="card-title">${artigo.Marca}</h4>
                    <a href="#" class="btn btn-primary"  data-bs-toggle="modal" data-bs-target="#myModal"  onclick="carregaModal('${artigo.Marca}', '${artigo.Detalhes}', this)">Ver detalhes</a>
                  </div>
                </div>
              </div>    
                   `;
        }
        document.getElementById("cardCarros").innerHTML = strHtml;
      };
      atualizarCarros();
    </script>
    <script>
      const listarCarros = async () => {
        let strHtml = ``;
        //alert("aaaa")
        const response = await fetch("http://localhost:4242/api/pgs/carros");
        const lv = await response.json();
        for (const artigo of lv) {
          strHtml += `
                    <tr>
                        <td>${artigo.id}</td>
                        <td>${artigo.Marca}</td>
                        <td>${artigo.Detalhes}</td>
                        <td>${artigo.Foto}</td>
                        <td>
                            <button type="button" class="btn btn-success" data-bs-toggle="modal" data-bs-target="#upModal" onclick="preparaEditCarro(${artigo.id})"><i class="fa fa-pencil"></i> Editar</button>
                            <button type='button' class='btn btn-danger' onclick="apagaCarro(${artigo.id})"><i class="fa fa-trash"></i> Apagar</button>
                        </td>
                    </tr>
                        `;
        }
        document.getElementById("cardCarros").innerHTML = strHtml;
      };
      listarCarros();
    </script>
  </body>
</html>
